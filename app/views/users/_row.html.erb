<li class="row user-list__row">
  <div class="row__wrapper drawer_trigger <%= cu.revision_count < 1 ? "disabled" : "" %>">
    <div class="user-list__row__name">
      <div class="avatar"><%= image_tag "/images/user.svg" %></div>
      <p class="name"><%= contribution_link(cu.user, nil, 'inline') %><br><small class="red"><%= cu.user.trained ? '' : t("user.training_incomplete.one") %></small></p>
    </div>
    <div class="user-list__row__training">
      <p class="training <%= !cu.user.trained ? 'red' : '' %>"><%= cu.user.trained ? t("user.training_complete_short") : t("user.training_incomplete_short") %></p>
    </div>
    <div class="user-list__row__assignee">
      <% @assignment = cu.user.assignments.where(course_id: @course.id).order('assignments.created_at DESC').first %>
      <% if @assignment.nil? %>
        <p class='assignee hidden'>ZZZ</p>
        <% if user_signed_in? && (current_user.instructor?(@course) || current_user.admin?) %>
          <p><span class='button dark assign' data-user_id='<%= cu.user_id %>' data-course_id='<%= cu.course.slug %>'>Assign an article</span></p>
        <% elsif user_signed_in? && current_user.id == cu.user.id %>
          <p><span class='button dark assign' data-user_id='<%= cu.user_id %>' data-course_id='<%= cu.course.slug %>'>Assign myself an article</span></p>
        <% else %>
          <p class='red'><%= t("user.assigned_none") %></p>
        <% end %>
      <% else %>
        <% if @assignment.article.nil? %>
        <p class='assignee'><i><%= @assignment.article_title %></i></p>
        <% else %>
        <p class='assignee'>
          <%= link_to full_title(@assignment.article), article_url(@assignment.article), :target => "_blank", :class => "inline" %>
          <span class='article_rating'><%= @assignment.article.rating %></span>
        </p>
        <% end %>
      <% end %>
    </div>
    <div class="user-list__row__reviewer">
      <% @assignment = cu.user.assignments.where(course_id: @course.id).order('assignments.created_at DESC').first %>
      <% if @assignment.nil? %>
        <p class='reviewer hidden'>ZZZ</p>
        <p class='red'><%= t("user.assigned_none") %></p>
      <% else %>
        <% unless @assignment.reviewers.empty? %>
        <p class='reviewer'><%= contribution_link(@assignment.reviewers.first, nil, 'inline') %></p>
        <% else %>
        <p class='reviewer hidden'>zzz</p>
        <% if user_signed_in? && (current_user.instructor?(@course) || current_user.admin?) %>
          <p><span class='button dark review' data-assignment_id='<%= @assignment.id %>' data-course_id='<%= cu.course.slug %>'>Add reviewer</span></p>
        <% elsif user_signed_in? && current_user.student?(@course) %>
          <p><span class='button dark review' data-assignment_id='<%= @assignment.id %>' data-course_id='<%= cu.course.slug %>'>Review this</span></p>
        <% else %>
          <p class='red'><%= t("user.reviewer_none") %></p>
        <% end %>
        <% end %>
      <% end %>
    </div>
    <div class="user-list__row__characters__mobile">
      <p class="characters-ms">
        <span>MS: </span>
        <span><%= cu.character_sum_ms %>, </span>
        <span>US: </span>
        <span><%= cu.character_sum_us %></span>
      </p>
    </div>
    <div class="user-list__row__characters-ms">
      <p class="characters-ms">
        <%= cu.character_sum_ms %>
      </p>
    </div>
    <div class="user-list__row__characters-us">
      <p class="characters-us">
        <%= cu.character_sum_us %>
      </p>
    </div>
    <div class="user-list__row__edits">
      <% @assignment = cu.user.assignments.where(course_id: @course.id).order('assignments.created_at DESC').first %>
      <% if @assignment.nil? %>
        <p class='edits red'><%= t("user.assigned_none") %></p>
      <% else %>
        <% if @assignment.article.nil? %>
        <p class='edits'><i><%= @assignment.article_title %></i></p>
        <% else %>
        <p class='edits'><%= link_to full_title(@assignment.article), article_url(@assignment.article), :target => "_blank", :class => "inline" %> <span class='article_rating'><%= @assignment.article.rating %></span></p>
        <% end %>
      <% end %>
    </div>
    <div class="user-list__row__link">
      <div class="drawer_trigger__icon <%= cu.revision_count < 1 ? "disabled" : "" %>"><p class="icon icon-arrow"></p></div>
    </div>
  </div>
  <%= render :partial => 'users/detail', :locals => {:user => cu.user} %>
</li>
